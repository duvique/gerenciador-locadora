version: '3.4'


volumes:
  datafiles:

services:
    site:
        image: website-react
        ports:
            - "5300:3000"
        depends_on:
            - locadora
        environment:
            - REACT_APP_API_URL=https://localhost:5001/api/
    locadora:
        image: ${DOCKER_REGISTRY-}locadora 
        ports:
            - "5000:5000"
            - "5001:5001"
        build:
            context: .
            dockerfile: locadora/Dockerfile
        depends_on: 
            - database
        environment: 
            - ASPNETCORE_URLS=http://*:5000
            - DBHOST=database
            - ASPNETCORE_ENVIRONMENT=Development
    database:
        image: mysql:latest
        ports:
            - "3306:3306"
        volumes:
            - datafiles:/var/lib/mysql
        restart: always
        environment: 
            MYSQL_ROOT_PASSWORD: Root@01
            MYSQL_USER: gerente-locadora
            MYSQL_PASSWORD: Locadora@2022
            MYSQL_DATABASE: Locadora
    
